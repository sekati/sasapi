<?xml version="1.0"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html><head><title>SASAPI</title><script src="../../../quicknav.js" type="text/javascript"></script><script><!--
document.quicknavBasePath="../../../index-files";
//--></script><link href="../../../style.css" title="JavaDoc" rel="stylesheet" type="text/css"/><link href="../../../unnatural.css" title="Unnatural" rel="alternate stylesheet" type="text/css"/><link href="../../../overview-summary.html" title="Overview" rel="top"/><meta name="generator" content="http://www.badgers-in-foil.co.uk/projects/as2api/"/></head><body><pre><span class="lineno" id="1">     1  </span><span class="comment doc">/**
<span class="lineno" id="2">     2  </span> * com.sekati.log.Console
<span class="lineno" id="3">     3  </span> * @version 1.0.7
<span class="lineno" id="4">     4  </span> * @author jason m horwitz | sekati.com
<span class="lineno" id="5">     5  </span> * Copyright (C) 2007  jason m horwitz, Sekat LLC. All Rights Reserved.
<span class="lineno" id="6">     6  </span> * Released under the MIT License: http://www.opensource.org/licenses/mit-license.php
<span class="lineno" id="7">     7  </span> */</span>
<span class="lineno" id="8">     8  </span>
<span class="lineno" id="9">     9  </span><span class="key">import</span> com.sekati.display.BaseClip; 
<span class="lineno" id="10">    10  </span><span class="key">import</span> com.sekati.events.Dispatcher;
<span class="lineno" id="11">    11  </span><span class="key">import</span> com.sekati.events.Event;
<span class="lineno" id="12">    12  </span><span class="key">import</span> com.sekati.log.ConsoleFPSMonitor;
<span class="lineno" id="13">    13  </span><span class="key">import</span> com.sekati.log.ConsoleItem;
<span class="lineno" id="14">    14  </span><span class="key">import</span> com.sekati.log.ConsoleStyle;
<span class="lineno" id="15">    15  </span><span class="key">import</span> com.sekati.ui.Scroll;
<span class="lineno" id="16">    16  </span><span class="key">import</span> com.sekati.utils.ClassUtils; 
<span class="lineno" id="17">    17  </span><span class="key">import</span> com.sekati.utils.Delegate;
<span class="lineno" id="18">    18  </span><span class="comment">//import flash.filters.DropShadowFilter;</span>
<span class="lineno" id="19">    19  </span> 
<span class="lineno" id="20">    20  </span><span class="comment doc">/**
<span class="lineno" id="21">    21  </span> * UI Console for attaching or connecting too
<span class="lineno" id="22">    22  </span> */</span>
<span class="lineno" id="23">    23  </span><span class="key">class</span> com.sekati.log.Console {
<span class="lineno" id="24">    24  </span>	
<span class="lineno" id="25">    25  </span>	<span class="comment">// core console props</span>
<span class="lineno" id="26">    26  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">var</span> _instance:Console;
<span class="lineno" id="27">    27  </span>	<span class="key">private</span> <span class="key">var</span> _this:Console;
<span class="lineno" id="28">    28  </span>	<span class="key">private</span> <span class="key">var</span> _cs:ConsoleStyle;
<span class="lineno" id="29">    29  </span>	<span class="key">private</span> <span class="key">var</span> _style:Object;
<span class="lineno" id="30">    30  </span>	
<span class="lineno" id="31">    31  </span>	<span class="comment">// ui props</span>
<span class="lineno" id="32">    32  </span>	<span class="key">private</span> <span class="key">var</span> _console:MovieClip;
<span class="lineno" id="33">    33  </span>	<span class="key">private</span> <span class="key">var</span> _head:MovieClip;
<span class="lineno" id="34">    34  </span>	<span class="key">private</span> <span class="key">var</span> _headTf:TextField;
<span class="lineno" id="35">    35  </span>	<span class="key">private</span> <span class="key">var</span> _fps:MovieClip;
<span class="lineno" id="36">    36  </span>	<span class="key">private</span> <span class="key">var</span> _holder:MovieClip;
<span class="lineno" id="37">    37  </span>	<span class="key">private</span> <span class="key">var</span> _list:MovieClip;
<span class="lineno" id="38">    38  </span>	<span class="key">private</span> <span class="key">var</span> _mask:MovieClip;
<span class="lineno" id="39">    39  </span>	<span class="key">private</span> <span class="key">var</span> _scroll:Scroll;
<span class="lineno" id="40">    40  </span>	<span class="key">private</span> <span class="key">var</span> _gutter:MovieClip;
<span class="lineno" id="41">    41  </span>	<span class="key">private</span> <span class="key">var</span> _bar:MovieClip;
<span class="lineno" id="42">    42  </span>	
<span class="lineno" id="43">    43  </span>	<span class="comment">// manager props</span>
<span class="lineno" id="44">    44  </span>	<span class="key">private</span> <span class="key">var</span> _logItems:Array;
<span class="lineno" id="45">    45  </span>	<span class="key">private</span> <span class="key">var</span> _logIndex:Number;
<span class="lineno" id="46">    46  </span>	<span class="key">private</span> <span class="key">var</span> _key:Object;
<span class="lineno" id="47">    47  </span>	
<span class="lineno" id="48">    48  </span>	<span class="comment doc">/**
<span class="lineno" id="49">    49  </span>	 * Singleton Private Constructor
<span class="lineno" id="50">    50  </span>	 */</span>
<span class="lineno" id="51">    51  </span>	<span class="key">private</span> <span class="key">function</span> Console() {
<span class="lineno" id="52">    52  </span>		_this = <span class="key">this</span>;
<span class="lineno" id="53">    53  </span>		_cs = ConsoleStyle.getInstance();
<span class="lineno" id="54">    54  </span>		_style = _cs.CSS;
<span class="lineno" id="55">    55  </span>		Dispatcher.$.addEventListener(<span class="str_const">"LOG_EVENT"</span>, Delegate.create (_this, onLogEvent));
<span class="lineno" id="56">    56  </span>		createUI();
<span class="lineno" id="57">    57  </span>	}
<span class="lineno" id="58">    58  </span>
<span class="lineno" id="59">    59  </span>	<span class="comment doc">/**
<span class="lineno" id="60">    60  </span>	 * Singleton Accessor
<span class="lineno" id="61">    61  </span>	 * @return Console
<span class="lineno" id="62">    62  </span>	 */</span>	
<span class="lineno" id="63">    63  </span>	<span class="key">public</span> <span class="key">static</span> <span class="key">function</span> getInstance():Console {
<span class="lineno" id="64">    64  </span>		<span class="key">if</span> (!_instance) {
<span class="lineno" id="65">    65  </span>			_instance = <span class="key">new</span> Console();
<span class="lineno" id="66">    66  </span>		}
<span class="lineno" id="67">    67  </span>		<span class="key">return</span> _instance;
<span class="lineno" id="68">    68  </span>	}
<span class="lineno" id="69">    69  </span>
<span class="lineno" id="70">    70  </span>	<span class="comment doc">/**
<span class="lineno" id="71">    71  </span>	 * shorthand singleton accessor getter
<span class="lineno" id="72">    72  </span>	 */</span>
<span class="lineno" id="73">    73  </span>	 <span class="key">public</span> <span class="key">static</span> <span class="key">function</span> get $():Console {
<span class="lineno" id="74">    74  </span>	 	<span class="key">return</span> Console.getInstance();	
<span class="lineno" id="75">    75  </span>	 }
<span class="lineno" id="76">    76  </span>	
<span class="lineno" id="77">    77  </span>	<span class="comment doc">/**
<span class="lineno" id="78">    78  </span>	 * Create the core Console UI
<span class="lineno" id="79">    79  </span>	 */</span>
<span class="lineno" id="80">    80  </span>	<span class="key">private</span> <span class="key">function</span> createUI():Void {
<span class="lineno" id="81">    81  </span>		<span class="comment">// rect	- createStyledRect (target:MovieClip, style:Object)</span>
<span class="lineno" id="82">    82  </span>		_console = _cs.createStyledRectangle(_level0, _style.console);
<span class="lineno" id="83">    83  </span>		_console._quality = <span class="str_const">"LOW"</span>;
<span class="lineno" id="84">    84  </span>		<span class="comment">//_console.filters = [new DropShadowFilter (3, 45, 0x000000, .5, 5, 5, 1, 3, false, false, false)];			</span>
<span class="lineno" id="85">    85  </span>		_head = _cs.createStyledRectangle(_console, _style.console.head);
<span class="lineno" id="86">    86  </span>		
<span class="lineno" id="87">    87  </span>		<span class="comment">// text - createStyledTextField (target:MovieClip, style:Object, str:String)</span>
<span class="lineno" id="88">    88  </span>		_headTf = _cs.createStyledTextField(_head, _style.console.head.textfields.head);
<span class="lineno" id="89">    89  </span>		
<span class="lineno" id="90">    90  </span>		<span class="comment">// create ConsoleFPSMonitor</span>
<span class="lineno" id="91">    91  </span>		_fps = ClassUtils.createEmptyMovieClip (com.sekati.log.ConsoleFPSMonitor, _head, _style.console.head.fps.n, {_x:_style.console.head.fps.x, _y:_style.console.head.fps.y});		
<span class="lineno" id="92">    92  </span>		
<span class="lineno" id="93">    93  </span>		<span class="comment">// create core ui clip holders</span>
<span class="lineno" id="94">    94  </span>		_holder = _cs.createPositionClip(_console, _style.console.holder);
<span class="lineno" id="95">    95  </span>		_list = _cs.createPositionClip(_holder, _style.console.holder.list);
<span class="lineno" id="96">    96  </span>		
<span class="lineno" id="97">    97  </span>		<span class="comment">// create core ui clip shapes</span>
<span class="lineno" id="98">    98  </span>		_mask = _cs.createStyledRectangle(_holder, _style.console.holder.mask);
<span class="lineno" id="99">    99  </span>		_gutter = _cs.createStyledRectangle(_holder, _style.console.holder.gutter);
<span class="lineno" id="100">   100  </span>		_bar = _cs.createStyledRectangle(_holder, _style.console.holder.bar);
<span class="lineno" id="101">   101  </span>		_bar._visible = <span class="key">false</span>;
<span class="lineno" id="102">   102  </span>		
<span class="lineno" id="103">   103  </span>		<span class="comment">// mask item list</span>
<span class="lineno" id="104">   104  </span>		_list.setMask(_mask);
<span class="lineno" id="105">   105  </span>		
<span class="lineno" id="106">   106  </span>		<span class="comment">// create scrollable functionality</span>
<span class="lineno" id="107">   107  </span>		<span class="comment">//_scroll = new Scroll("_y", _list, _mask, _gutter, _bar, true, true, true, true, _list);</span>
<span class="lineno" id="108">   108  </span>		_scroll = <span class="key">new</span> Scroll(<span class="str_const">"_y"</span>, _list, _mask, _gutter, _bar, <span class="key">true</span>, <span class="key">true</span>, <span class="key">true</span>, <span class="key">true</span>, _list, <span class="num_const">0</span>.<span class="num_const">05</span>, <span class="num_const">0</span>.<span class="num_const">5</span>);
<span class="lineno" id="109">   109  </span>	
<span class="lineno" id="110">   110  </span>		<span class="comment">// EVENTS start</span>
<span class="lineno" id="111">   111  </span>		
<span class="lineno" id="112">   112  </span>		<span class="comment">// make console draggable</span>
<span class="lineno" id="113">   113  </span>		_head.onPress  = Delegate.create (_console, startDrag);
<span class="lineno" id="114">   114  </span>		_head.onRelease = _head.onReleaseOutside = Delegate.create (_console, stopDrag);	
<span class="lineno" id="115">   115  </span>		
<span class="lineno" id="116">   116  </span>		<span class="comment">// EVENTS stop</span>
<span class="lineno" id="117">   117  </span>		
<span class="lineno" id="118">   118  </span>		<span class="comment">// position the console on stage.</span>
<span class="lineno" id="119">   119  </span>		_console._x = _style.console.startx;
<span class="lineno" id="120">   120  </span>		_console._y = _style.console.starty;
<span class="lineno" id="121">   121  </span>		
<span class="lineno" id="122">   122  </span>		<span class="comment">// create the meta item</span>
<span class="lineno" id="123">   123  </span>		ClassUtils.createEmptyMovieClip (com.sekati.log.ConsoleItem, _list, <span class="str_const">"metaItem"</span>, {_x:<span class="num_const">0</span>, _y:<span class="num_const">0</span>, _data:{_isMeta:<span class="key">true</span>}});
<span class="lineno" id="124">   124  </span>		
<span class="lineno" id="125">   125  </span>		<span class="comment">//runItemTest();</span>
<span class="lineno" id="126">   126  </span>		
<span class="lineno" id="127">   127  </span>		<span class="comment">// keylistener</span>
<span class="lineno" id="128">   128  </span>		_key = <span class="key">new</span> Object ();
<span class="lineno" id="129">   129  </span>		_key.onKeyDown = <span class="key">function</span> ():Void  {
<span class="lineno" id="130">   130  </span>			<span class="key">if</span> (Key.isDown (Key.UP) &amp;&amp; Key.isDown (Key.LEFT)) {
<span class="lineno" id="131">   131  </span>				_console._visible = !_console._visible;
<span class="lineno" id="132">   132  </span>			}
<span class="lineno" id="133">   133  </span>			<span class="comment">/*
<span class="lineno" id="134">   134  </span>			if ((Key.isDown (Key.SHIFT) &amp;&amp; (Key.isDown (Key.BACKSPACE) || Key.isDown (Key.DELETEKEY)))) {
<span class="lineno" id="135">   135  </span>				Delegate.create (_this,clearOutput);
<span class="lineno" id="136">   136  </span>			}
<span class="lineno" id="137">   137  </span>			 */</span>
<span class="lineno" id="138">   138  </span>		};
<span class="lineno" id="139">   139  </span>		Key.addListener (_key);		
<span class="lineno" id="140">   140  </span>	}
<span class="lineno" id="141">   141  </span>
<span class="lineno" id="142">   142  </span>	<span class="comment doc">/**
<span class="lineno" id="143">   143  </span>	 * create a test set of data Items for ConsoleItem test.
<span class="lineno" id="144">   144  </span>	 * TODO remove me!
<span class="lineno" id="145">   145  </span>	 */</span>
<span class="lineno" id="146">   146  </span>	<span class="key">private</span> <span class="key">function</span> runItemTest():Void {
<span class="lineno" id="147">   147  </span>		<span class="comment">// create a block of consoleItems.</span>
<span class="lineno" id="148">   148  </span>		<span class="key">var</span> lipsum0:String = <span class="str_const">"Sed enim. Sed ac augue et elit lacinia sodales. Nunc ultricies est in leo. Nunc nulla mi, rhoncus eget, dignissim a, tincidunt quis, ligula. Nulla facilisi. Aenean luctus, metus id pharetra ullamcorper, est odio fringilla justo, commodo blandit ante lacus id nulla. Nulla vel orci a nunc malesuada elementum. Sed augue tortor, pellentesque a, tristique quis, lacinia id, purus. Suspendisse potenti. Pellentesque venenatis eros sit amet metus. Morbi convallis enim at massa aliquet bibendum."</span>;
<span class="lineno" id="149">   149  </span>		<span class="key">var</span> lipsum1:String = <span class="str_const">"\n\nVestibulum eget urna vitae ante venenatis sodales. Nam adipiscing blandit odio. Nulla facilisi. Donec ultrices turpis at lacus. Cras sit amet turpis. Vivamus at justo. Aenean blandit tortor sit amet ante. Praesent scelerisque massa eu metus. Mauris nec metus. Phasellus at elit non dui tincidunt eleifend. Mauris congue placerat dui."</span>;
<span class="lineno" id="150">   150  </span>		
<span class="lineno" id="151">   151  </span>		<span class="key">var</span> data0:Object = {id:<span class="num_const">0</span>, type:<span class="str_const">"trace"</span>, origin:<span class="str_const">"_level0.myArr[3]"</span>, message:lipsum0, benchmark:<span class="num_const">0</span>.<span class="num_const">122</span>};
<span class="lineno" id="152">   152  </span>		<span class="key">var</span> data1:Object = {id:<span class="num_const">1</span>, type:<span class="str_const">"info"</span>, origin:<span class="str_const">"_level0"</span>, message:<span class="str_const">"Generic status report."</span>, benchmark:<span class="num_const">0</span>.<span class="num_const">3339</span>};
<span class="lineno" id="153">   153  </span>		<span class="key">var</span> data2:Object = {id:<span class="num_const">2</span>, type:<span class="str_const">"status"</span>, origin:<span class="str_const">"Dispatcher"</span>, message:<span class="str_const">"Generic info report."</span>, benchmark:<span class="num_const">1</span>.<span class="num_const">19</span>};
<span class="lineno" id="154">   154  </span>		<span class="key">var</span> data3:Object = {id:<span class="num_const">3</span>, type:<span class="str_const">"warn"</span>, origin:<span class="str_const">"myClass.isWrong"</span>, message:<span class="str_const">"Generic warn report.\n\n"</span>+lipsum0+lipsum1, benchmark:<span class="num_const">0</span>.<span class="num_const">29</span>};
<span class="lineno" id="155">   155  </span>		<span class="key">var</span> data4:Object = {id:<span class="num_const">4</span>, type:<span class="str_const">"error"</span>, origin:<span class="str_const">"Scroll"</span>, message:<span class="str_const">"Generic error report."</span>, benchmark:<span class="num_const">0</span>.<span class="num_const">01</span>};
<span class="lineno" id="156">   156  </span>		<span class="key">var</span> data5:Object = {id:<span class="num_const">5</span>, type:<span class="str_const">"fatal"</span>, origin:<span class="str_const">"Document.main"</span>, message:<span class="str_const">"Generic fatal report."</span>, benchmark:<span class="num_const">0</span>.<span class="num_const">01</span>};
<span class="lineno" id="157">   157  </span>		<span class="key">var</span> data6:Object = {id:<span class="num_const">6</span>, type:<span class="str_const">"object"</span>, origin:<span class="str_const">"App.db"</span>, message:<span class="str_const">"Custom Object report."</span>, benchmark:<span class="num_const">13</span>.<span class="num_const">0012</span>};
<span class="lineno" id="158">   158  </span>		<span class="key">var</span> data7:Object = {id:<span class="num_const">6</span>, type:<span class="str_const">"custom"</span>, origin:<span class="str_const">"TextUtils.test"</span>, message:<span class="str_const">"Custom report."</span>, benchmark:<span class="num_const">1</span>.<span class="num_const">0012</span>};
<span class="lineno" id="159">   159  </span>		addItem(data0);
<span class="lineno" id="160">   160  </span>		addItem(data1);
<span class="lineno" id="161">   161  </span>		addItem(data2);
<span class="lineno" id="162">   162  </span>		addItem(data3);
<span class="lineno" id="163">   163  </span>		addItem(data4);
<span class="lineno" id="164">   164  </span>		addItem(data5);	
<span class="lineno" id="165">   165  </span>		addItem(data6);	
<span class="lineno" id="166">   166  </span>		addItem(data7);			
<span class="lineno" id="167">   167  </span>	}
<span class="lineno" id="168">   168  </span>	
<span class="lineno" id="169">   169  </span>	<span class="comment doc">/**
<span class="lineno" id="170">   170  </span>	 * Add and return a new ConsoleItem
<span class="lineno" id="171">   171  </span>	 * @param data (Object) ConsoleItem._data = {id:Number, type:String, origin:String, message:String, benchmark:Number, _isMeta:Boolean}
<span class="lineno" id="172">   172  </span>	 * @return 	MovieClip
<span class="lineno" id="173">   173  </span>	 */</span>
<span class="lineno" id="174">   174  </span>	<span class="key">public</span> <span class="key">function</span> addItem (data:Object):MovieClip {
<span class="lineno" id="175">   175  </span>		<span class="key">var</span> item:MovieClip = ClassUtils.createEmptyMovieClip (com.sekati.log.ConsoleItem, _list, <span class="str_const">"consoleItem_"</span>+data.id, {_x:<span class="num_const">0</span>, _y:_list._height, _data:data});
<span class="lineno" id="176">   176  </span>		
<span class="lineno" id="177">   177  </span>		_global[<span class="str_const">"setTimeout"</span>](_scroll,<span class="str_const">"slideContent"</span>,<span class="num_const">50</span>, item._y+item._height);
<span class="lineno" id="178">   178  </span>
<span class="lineno" id="179">   179  </span>		<span class="key">return</span> item;
<span class="lineno" id="180">   180  </span>	}
<span class="lineno" id="181">   181  </span>	
<span class="lineno" id="182">   182  </span>	<span class="comment doc">/**
<span class="lineno" id="183">   183  </span>	 * Handle events from Logger and parse them to addItem
<span class="lineno" id="184">   184  </span>	 * @param eventObj (Event)
<span class="lineno" id="185">   185  </span>	 * @return Void
<span class="lineno" id="186">   186  </span>	 */</span> 
<span class="lineno" id="187">   187  </span>	<span class="key">private</span> <span class="key">function</span> onLogEvent (eventObj:Event):Void {
<span class="lineno" id="188">   188  </span>		<span class="comment">//trace ("eventObj{target:" + eventObj.target + ",type:" + eventObj.type + ",message:" + eventObj.data.message + "};");</span>
<span class="lineno" id="189">   189  </span>		addItem(eventObj.data);
<span class="lineno" id="190">   190  </span>	}
<span class="lineno" id="191">   191  </span>}</pre><ul class="main_nav" id="main_nav"><li><a href="../../../overview-summary.html" title="Overview of SASAPI" class="button">Overview</a></li><li><a href="package-summary.html" title="Overview of package com.sekati.log" class="button">Package</a></li><li><a href="Console.html" title="Detail of com.sekati.log.Console API" class="button">Class</a></li><li><span class="button nav_current">Source</span></li><li><a href="../../../index-files/index.html" title="Alpabetical index of types and members" class="button">Index</a></li></ul><div class="footer"><a href="http://www.badgers-in-foil.co.uk/projects/as2api/" title="ActionScript 2 API Documentation Generator">as2api</a></div></body></html>